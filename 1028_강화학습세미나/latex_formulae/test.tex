\documentclass{article}
\usepackage{amsmath, amssymb, kotex}

\begin{document}
\section{강화학습 기초}
\subsection{강화학습 개요}
\subsection{MDP}
\subsection{가치함수}
$$
v_\pi(s)=\mathbb E_\pi\left[G_t\vert S_t=s\right]
$$

$$
q_\pi(s)=\mathbb E_\pi\left[G_t\vert S_t=s,A_t=a\right]
$$

$$
v_{\pi_\ast}(s)\ge v_\pi(s),\quad\forall s\in\mathcal S,\;\forall\pi
$$

\subsection{벨만방정식}
$$
v_{\pi_\ast}(s) = \max_\pi v_\pi(s)\quad\forall s\in\mathcal S
$$

\begin{align*}
    v_\pi(s)
    &=\sum_a\pi(a\vert s)\sum_{s',r}p(s',r\vert s,a)\left[r+\gamma v_\pi(s')\right]\\
    &=\mathbb E_\pi\left[R_{t+1}+\gamma v_\pi(S_{t+1})\vert S_t=s\right]\\
    q_\pi(s,a)
    &=\sum_{s',r}p(s',r\vert s,a)\left[r+\gamma\sum_{a'}\pi(a'\vert s')q_\pi(s',a')\right]\\
    &=\mathbb E_\pi\left[R_{t+1}+\gamma q_\pi(S_{t+1},A_{t+1})\vert S_t=s, A_t=a\right]
\end{align*}

\begin{align*}
v_\pi\left((1,2)\right)=&-0.865\\
&\sum_a\pi(a\vert s)\sum_{s',r}p(s',r\vert s,a)\left[r+\gamma v_\pi(s')\right]\\
=&0.25 \times (-0.1 + 0.9\times(-0.761))\\
&+0.25 \times (-0.1 + 0.9\times(-0.909))\\
&+0.25 \times (-0.1 + 0.9\times(-0.865))\\
&+0.25 \times (-0.1 + 0.9\times(-0.865))\\
=&0.865
\end{align*}

\begin{align*}
q_\pi\left((1,2),\uparrow\right)=&-0.78\\
&\sum_{s',r}p(s',r\vert s,a)\left[r+\gamma\sum_{a'}\pi(a'\vert s')q_\pi(s',a')\right]\\
=&1\times\left[-0.1+0.9\sum_{a'}\pi(a'\vert s')q_\pi(s',a')\right]\\
=&-0.1+0.9\times0.25\left((-0.78)+(-0.78)+(-0.88)+(-0.60)\right)\\
=&0.784
\end{align*}

$$
\pi_\ast(s) = \text{arg}\max_aq_\ast(s,a)
$$

\section{강화학습 알고리즘}

\subsection{Dynamic Programming}

\subsection{Monte Carlo}

$$
\mu_k
=\frac1k\sum_{i=1}^kx_i=\frac1k\left(\sum_{i=1}^{k-1}x_i+x_k\right)=\frac1k\left((k-1)\mu_{k-1}+x_k\right)=\mu_{k-1}+\frac1k(x_k-\mu_{k-1})
$$

\begin{align*}
    n(S_t,A_t)&\leftarrow n(S_t,A_t)+1\\
    Q(S_t,A_t)&\leftarrow Q(S_t,A_t)+\frac1{n(S_t,A_t)}\left[G_t-Q(S_t,A_t)\right]\\
\end{align*}

$$Q(S_t,A_t)\leftarrow Q(S_t,A_t)+\alpha\left[G_t-Q(S_t,A_t)\right]$$

\subsection{Temporal Difference Learning}
$$V(S_t)\leftarrow V(S_t)+\alpha\left[G_t-V(S_t)\right]$$

$$V(S_t)\leftarrow V(S_t)+\alpha\left[R_{t+1}+\gamma V(S_{t+1})-V(S_t)\right]$$

\begin{align*}
v_\pi(s)
&=\mathbb E_\pi\left[G_t\vert S_t=s\right]\\
&=\mathbb E_\pi\left[R_{t+1}+\gamma G_{t+1}\vert S_t=s\right]\\
&=\mathbb E_\pi\left[R_{t+1}+\gamma v_\pi(S_{t+1})\vert S_t=s\right]
\end{align*}


$$Q(S_t,A_t)\leftarrow Q(S_t,A_t)+\alpha\left[R_{t+1}+\gamma Q(S_{t+1},A_{t+1})-Q(S_t,A_t)\right]$$

\begin{align*}
q_\pi(s,a)
&=\mathbb E_\pi\left[G_t\vert S_t=s,A_t=a\right]\\
&=\mathbb E_\pi\left[R_{t+1}+\gamma G_{t+1}\vert S_t=s,A_t=a\right]\\
&=\mathbb E_\pi\left[R_{t+1}+\gamma v_\pi(S_{t+1},A_{t+1})\vert S_t=s,A_t=a\right]
\end{align*}

$$Q(S_t,A_t)\leftarrow Q(S_t,A_t)+\alpha\left[R_{t+1}+\gamma\max_aQ(S_{t+1},a)-Q(S_t,A_t)\right]$$

\end{document}